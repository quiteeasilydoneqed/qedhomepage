---
layout: post
title: "q-模拟和q-级数及其应用"
subtitle: "整数分拆, 雅可比三重积恒等式, 罗杰斯-拉马努金恒等式等"
author: "QED"
header-img: "img/post-bg-infinity.jpg"
header-mask: 0.3
math: true
tags:
  - 数论
---


# q-模拟基础

若无特殊说明, 以下内容均在形式幂级数环$\mathbb{C}[[q]]$中讨论, 仅在必要时对$q$取特定值并讨论其收敛性.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-整数)</b>

对于非负整数$n$, q-整数定义为:
$$
[n]_q = 1 + q + q^2 + \cdots + q^{n-1} = \frac{1 - q^n}{1 - q},
$$
特别地, $[0]_q = 0$. 当$q \to 1$时, $[n]_q \to n$, 即退化为普通整数.

</div><br>

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-阶乘)</b>

对于非负整数$n$, q-阶乘定义为q-整数的乘积:
$$
[n]_q! = \prod_{k=1}^n [k]_q = [1]_q [2]_q \cdots [n]_q,
$$
其中约定$[0]_q! = 1$. 其等价表达式为:
$$
[n]_q! = \frac{(1 - q)(1 - q^2) \cdots (1 - q^n)}{(1 - q)^n},
$$
当$q \to 1$时, $[n]_q! \to n!$, 即退化为普通阶乘.

</div><br>

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-波赫哈默符号)</b>

q-波赫哈默符号定义为: 对于复数$a$, 定义
$$
(a; q)_\infty = \prod_{k=0}^\infty (1 - a q^k)=(1-a)(1-aq)(1-aq^2)(1-aq^3)\cdots,
$$

对任意整数$n$, 定义
$$
(a; q)_n =\frac{(a; q)_\infty}{(aq^n; q)_\infty},
$$

显然, 当$n=0$时, $(a; q)_0 = 1$, 当$n$为正整数时, 有
$$
(a; q)_n = \prod_{k=0}^{n-1} (1 - a q^k)=(1-a)(1-aq)(1-aq^2)\cdots(1-aq^{n-1}),
$$

$$
(a; q)_{-n} = \frac{1}{(aq^{-n}; q)_n} = \prod_{k=1}^{n}\frac{1}{1 - a q^{-k}}.
$$
</div>

注: 当$a=q$时, 有记法$\phi(q)=(q;q)_\infty$, 称为欧拉函数. 在不引起混淆的情况下, 有如下简记法: $(a)_n=(a;q)_n$, $(a)_\infty=(a;q)_\infty$, $(a,b;q)_n=(a;q)_n(b;q)_n$, $(a,b;q)_\infty=(a;q)_\infty(b;q)_\infty$, 更多元的情况类似. 使用q-波赫哈默符号, 就有:
$$
[n]_q!=\frac{(q;q)_n}{(1-q)^n}.
$$


<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-二项式系数)</b>

对于整数$0 \leq k \leq n$, q-二项式系数定义为:
$$
\binom{n}{k}_q = \frac{[n]_q!}{[k]_q! \, [n - k]_q!},
$$
当$k > n$或$k < 0$时, 约定$\binom{n}{k}_q = 0$. 等价的, 有
$$
\binom{n}{k}_q = \frac{(1 - q^n)(1 - q^{n-1}) \cdots (1 - q^{n - k + 1})}{(1 - q^k)(1 - q^{k - 1}) \cdots (1 - q)},
$$
当$q \to 1$时, $\binom{n}{k}_q \to \binom{n}{k}$.

</div>

一个有趣的组合事实是, 当$q$取素数的幂时, $q$阶有限域$\mathbb{F}_q$上的$n$维向量空间$\mathbb{F}_q^n$中, $k$维子空间的个数恰好就是$\binom{n}{k}_q$, 也就是说格拉斯曼簇$\mathrm{Gr}(k,\mathbb{F}_q^n)$的元素个数即为$\binom{n}{k}_q$.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(q-杨辉恒等式)</b>

$$
\binom{n}{k}_q=q^k\binom{n-1}{k}_q+\binom{n-1}{k-1}_q,
$$
$$
\binom{n}{k}_q=\binom{n-1}{k}_q+q^{n-k}\binom{n-1}{k-1}_q.
$$
</div>

<div style="border: 3px solid #000; padding: 10px;">

<b>proof</b>

直接按定义验证即可.

</div><br>

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(q-二项式定理)</b>

对于非负整数$n$, 有:
$$
\prod_{k=0}^{n-1} (1 + q^k x) = \sum_{k=0}^n \binom{n}{k}_q q^{\frac{k(k-1)}{2}} x^k
$$
当$q \to 1$时, 退化为普通二项式定理$(1 + x)^n = \sum_{k=0}^n \binom{n}{k} x^k$, 对于负数情况, 有:
$$
\prod_{k=0}^{n-1}\frac{1}{1 - q^k x}= \sum_{k=0}^\infty \binom{n+k-1}{k}_q x^k,
$$
当$q \to 1$时, 即为$(1 - x)^{-n} = \sum_{k=0}^\infty \binom{n+k-1}{k} x^k$.
</div>

<div style="border: 3px solid #000; padding: 10px;">

<b>proof</b>

由归纳法和q-杨辉恒等式即可证明, 但我们这里使用另一种方法证明第一个式子, 这种方法在q-级数理论中十分常用, 第二个式子也可以类似证明.

定义$K_n(x)$为
$$
K_n(x) = \prod_{k=0}^{n-1} (1 + q^k x) = \sum_{k=0}^n c_k x^k
$$
其中$c_k$为展开式中$x^k$的系数, 显然有
$$
(1+q^nx)K_n(x)=(1+x)K_n(qx),
$$
代入幂级数并比较系数得递推公式
$$
c_k+q^nc_{k-1}=q^kc_k+q^{k-1}c_{k-1},
$$
即$(1-q^k)c_k=(q^{k-1}-q^n)c_{k-1}$, 因$c_0=1$, 故$c_1=\frac{1-q^n}{1-q}=\binom{n}{1}$, 若$c_{k-1}=\binom{n}{k-1} q^{\frac{(k-1)(k-2)}{2}}$, 则$c_k=\frac{q^{k-1}-q^n}{1-q^k}\binom{n}{k-1} q^{\frac{(k-1)(k-2)}{2}}=\binom{n}{k}q^{k-1}q^{\frac{(k-1)(k-2)}{2}}=\binom{n}{k}q^{\frac{k(k-1)}{2}}$, 由归纳法知定理成立.

</div>

# q-分析学

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-导数)</b>

设$f$是一个实函数, 则定义其q-导数为

$$
D_qf(x)=\frac{f(x)-f(qx)}{x-qx},
$$

当$f$可导时, 令$q\to 1$有$\lim_{q\to1}D_qf(x)=f'(x)$.
</div>

可做一些简单的计算, 设$f(x)=x^a$, 这里$a$是任意实数, 则有

$$
D_qx^a=\frac{x^a-(qx)^{a}}{x-qx}=\frac{1-q^a}{1-q}x^{a-1}=[a]_qx^{a-1},
$$

其中$[a]_q$形式地定义为$\frac{1-q^a}{1-q}$.

显然q-导数是线性的, 即$D_q(f+g)=D_qf+D_qg$, $D_q(kf)=kD_qf$, 并且有q-莱布尼兹律

$$
D_q^n(f(x)g(x))=\sum_{k=0}^n\binom{n}{k}_q\left(D_q^{n-k}f(q^kx)\right)\left(D_q^kg(x)\right),
$$

该公式由归纳法即可证明, 当$g\neq 0$时, 对$\frac{f}{g}$亦有对应求导公式.

一个自然的想法是寻找一个在q-导数下不变的函数, 即q-指数函数, 定义为:

$$
\exp_q(x)=\sum_{k=0}^\infty\frac{x^k}{[k]_q!},
$$

则有$D_q\exp_q(x)=\exp_q(x)$, 且$\lim_{q\to1}\exp_q(x)=e^x$. 实际上这里定义域可以取到复数, 其中要求$|q|<1$, 收敛性是显然的, 以后用$z$表示复数.

由此我们可以定义q-三角函数

$$
\sin_q (z)=\frac{\exp_q(iz)-\exp_q(-iz)}{2i},\cos_q (z)=\frac{\exp_q(iz)+\exp_q(-iz)}{2},
$$

当$q$趋于1时即为通常的三角函数.

接下来定义q-积分.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-积分)</b>

设$f$在积分域上有定义, $a,b\in\mathbb{R}$, 则q-积分定义为：

$$
\int_0^a f(x) \mathrm{d}_q x = a(1 - q) \sum_{n=0}^\infty f(a q^n) q^n,
$$

$$
\int_0^\infty f(x)\mathrm{d}_q x = (1 - q) \sum_{n=-\infty}^\infty f(q^n) q^n,
$$

$$
\int_b^a f(x) \mathrm{d}_q x =\int_0^a f(x) \mathrm{d}_q x -\int_0^b f(x) \mathrm{d}_q x,
$$

各无界区间的积分类似定义, 若$f$在积分域内可积, 则当$q\to1$时即为通常的积分.
</div><br>

q-积分的线性性是显然的, 接下来证明q-微积分基本定理.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(q-微积分基本定理)</b>

当$0<q<1$时, 有

$$
D_q\left(\int_0^xf(t)\mathrm{d}_q t\right)=f(x),
$$

$$
\int_0^xD_qf(t)\mathrm{d}t=f(x)-f(0).
$$
</div>

<div style="border: 3px solid #000; padding: 10px;">

<b>proof</b>

由

$$
D_q\left(\int_0^xf(t)\mathrm{d}_q t\right)=\frac{\int_0^xf(t)\mathrm{d}_qt-\int_0^{qx}f(t)\mathrm{d}_qt}{x-qx}\\
=\sum_{n=0}^\infty f(x q^n) q^n-\sum_{n=0}^\infty f(x q^{n+1}) q^{n+1}=f(x),
$$

$$
\int_0^xD_qf(t)\mathrm{d}t=x(1 - q) \sum_{n=0}^\infty \frac{f(xq^n)-f(xq^{n+1})}{xq^n-xq^{n+1}} q^n\\
=\sum_{n=0}^\infty \left(f(xq^n)-f(xq^{n+1})\right)=f(x)-f(0),
$$

即可得证.
</div><br>

如果记$D_q(g(t))\mathrm{d}_qt$为$\mathrm{d}_qg(t)$, 则有q-黎曼斯蒂尔杰斯积分或q-换元法.

$$
\int_0^xf(t)\mathrm{d}g(t)=\sum_{n=0}^\infty f(xq^n)\left(g(xq^n)-g(xq^{n+1})\right).
$$

q-微积分在q-特殊函数论中有重要的应用, 下面介绍一些重要的q-特殊函数.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-伽马函数)</b>

当$|q|<1$时, 定义

$$
\Gamma_q(x) =(1 - q)^{1 - x} \frac{(q;q)_\infty}{(q^x;q)_\infty}.
$$
</div><br>

显然有$\Gamma_q(x+1)=[x]_q\Gamma_q(x)$, 并且当$n$是正整数时, $\Gamma_q(n)=[n-1]_q!$, 可以证明$\lim_{q\to1}\Gamma_q(x)=\Gamma(x)$.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-贝塔函数)</b>

当$|q|<1$时, 定义

$$
B_q(x,y) = \frac{\Gamma_q(x)\Gamma_q(y)}{\Gamma_q(x+y)}.
$$
</div><br>

我们知道广义超几何函数定义为

$$
_rF_s(a_1,\dots,a_r;b_1,\dots,b_s;z)= _rF_s\left[
\begin{matrix}a_1 \ldots a_r\\b_1 \ldots b_s\end{matrix};z\right]= \sum_{n=0}^\infty\frac{(a_1)_n\cdots(a_r)_n}{(b_1)_n\cdots(b_s)_n}\frac{z^n}{n!},
$$

其中$(a)_n=\frac{\Gamma(a+n)}{\Gamma(a))}=a(a+1)\cdots(a+n-1)$为上升阶乘, 当$r=2$, $s=1$时, $_2F_1$即为超几何函数, 广义超几何函数在特殊函数论中十分重要, 它的q-模拟称为q-超几何函数或基本超几何函数:

$$
\displaylines{_r\phi_s(a_1,\dots,a_r;b_1,\dots,b_s;q,z)= _r\phi_s\left[
 \begin{matrix}
  a_1 \ldots a_r\\
  b_1 \ldots b_s
 \end{matrix}
;q,z\right]\\
=\sum_{n=0}^\infty\frac{(a_1,\dots,a_r;q)_n}{(b_1,\dots,b_s;q)_n}\frac{z^n}{(q,q)_n}\left((-1)^nq^{\frac{n(n-1)}{2}}\right)^{1+s-r},}
$$

有

$$
\lim_{q\to1}\ _r\phi_s\left[
 \begin{matrix}
  q^{a_1} \ldots q^{a_r}\\
  q^{b_1} \ldots q^{b_s}
 \end{matrix}
;q,\left(1-q\right)^{1+s-r}z\right]= _rF_s\left[
 \begin{matrix}
  a_1 \ldots a_r\\
  b_1 \ldots b_s
 \end{matrix}
;z\right],
$$

此外还有双边求和情形, 用$\psi$表示:

$$
_r\psi_s(a_1,\dots,a_r;b_1,\dots,b_s;q,z)= _r\psi_s\left[
 \begin{matrix}
  a_1 \ldots a_r\\
  b_1 \ldots b_s
 \end{matrix}
;q,z\right]\\
=\sum_{n=-\infty}^\infty\frac{(a_1,\dots,a_r;q)_n}{(b_1,\dots,b_s;q)_n}z^n\left((-1)^nq^{\frac{n(n-1)}{2}}\right)^{s-r},
$$

其中$r=s=1$时称为拉马努金$_1\psi_1$求和.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(拉马努金$_1\psi_1$求和公式)</b>

设$a,b,z$是复数, 当$\left|\frac{b}{a}\right|<|z|<1$时有

$$
_1\psi_1(a;b;q,z)=\frac{\left(q,\frac{b}{a},az,\frac{q}{az};q\right)_\infty}{\left(b,\frac{q}{a},z,\frac{b}{az};q\right)_\infty}.
$$
</div>

证明见[1]的定理1.3.12.
