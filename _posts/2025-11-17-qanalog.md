---
layout: post
title: "q-模拟和q-级数及其应用"
subtitle: "整数分拆, 雅可比三重积恒等式, 罗杰斯-拉马努金恒等式等"
header-img: "img/post-bg-infinity.jpg"
header-mask: 0.3
math: true
tags:
  - 数论
---


## q-模拟基础

若无特殊说明, 以下内容均在形式幂级数环  $  \mathbb{C}[[q]]  $  中讨论, 仅在必要时对  $  q  $  取特定值并讨论其收敛性.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-整数)</b>

对于非负整数  $  n  $, q-整数定义为:
$$
[n]_q = 1 + q + q^2 + \cdots + q^{n-1} = \frac{1 - q^n}{1 - q},
$$
特别地,   $  [0]_q = 0  $. 当  $  q \to 1  $  时,   $  [n]_q \to n  $, 即退化为普通整数.

</div><br>

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-阶乘)</b>

对于非负整数  $  n  $, q-阶乘定义为q-整数的乘积:
$$
[n]_q! = \prod_{k=1}^n [k]_q = [1]_q [2]_q \cdots [n]_q,
$$
其中约定  $  [0]_q! = 1  $. 其等价表达式为:
$$
[n]_q! = \frac{(1 - q)(1 - q^2) \cdots (1 - q^n)}{(1 - q)^n},
$$
当  $  q \to 1  $  时,   $  [n]_q! \to n!  $, 即退化为普通阶乘.

</div><br>

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-波赫哈默符号)</b>

q-波赫哈默符号定义为: 对于复数  $  a  $, 定义
$$
(a; q)_\infty = \prod_{k=0}^\infty (1 - a q^k)=(1-a)(1-aq)(1-aq^2)(1-aq^3)\cdots,
$$

对任意整数  $  n  $, 定义
$$
(a; q)_n =\frac{(a; q)_\infty}{(aq^n; q)_\infty},
$$

显然, 当  $  n=0  $  时,   $  (a; q)_0 = 1  $, 当  $  n  $  为正整数时, 有
$$
(a; q)_n = \prod_{k=0}^{n-1} (1 - a q^k)=(1-a)(1-aq)(1-aq^2)\cdots(1-aq^{n-1}),
$$

$$
(a; q)_{-n} = \frac{1}{(aq^{-n}; q)_n} = \prod_{k=1}^{n}\frac{1}{1 - a q^{-k}}.
$$
</div>

注: 当  $  a=q  $  时, 有记法  $  \phi(q)=(q;q)_\infty  $, 称为欧拉函数. 在不引起混淆的情况下, 有如下简记法:   $  (a)_n=(a;q)_n  $,   $  (a)_\infty=(a;q)_\infty  $,   $  (a,b;q)_n=(a;q)_n(b;q)_n  $,   $  (a,b;q)_\infty=(a;q)_\infty(b;q)_\infty  $, 更多元的情况类似. 使用q-波赫哈默符号, 就有:
$$
[n]_q!=\frac{(q;q)_n}{(1-q)^n}.
$$


<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-二项式系数)</b>

对于整数  $  0 \leq k \leq n  $, q-二项式系数定义为:
$$
\binom{n}{k}_q = \frac{[n]_q!}{[k]_q! \, [n - k]_q!},
$$
当  $  k > n  $  或  $  k < 0  $  时, 约定  $  \binom{n}{k}_q = 0  $. 等价的, 有
$$
\binom{n}{k}_q = \frac{(1 - q^n)(1 - q^{n-1}) \cdots (1 - q^{n - k + 1})}{(1 - q^k)(1 - q^{k - 1}) \cdots (1 - q)},
$$
当  $  q \to 1  $  时,   $  \binom{n}{k}_q \to \binom{n}{k}  $.

</div>

一个有趣的组合事实是, 当  $  q  $  取素数的幂时,   $  q  $  阶有限域  $  \mathbb{F}_q  $  上的  $  n  $  维向量空间  $  \mathbb{F}_q^n  $  中,   $  k  $  维子空间的个数恰好就是  $  \binom{n}{k}_q  $, 也就是说格拉斯曼簇  $  \mathrm{Gr}(k,\mathbb{F}_q^n)  $  的元素个数即为  $  \binom{n}{k}_q  $.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(q-杨辉恒等式)</b>

$$
\binom{n}{k}_q=q^k\binom{n-1}{k}_q+\binom{n-1}{k-1}_q,
$$
$$
\binom{n}{k}_q=\binom{n-1}{k}_q+q^{n-k}\binom{n-1}{k-1}_q.
$$
</div>

<div style="border: 3px solid #000; padding: 10px;">

<b>证明:</b>

直接按定义验证即可.

</div><br>

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(q-二项式定理)</b>

对于非负整数  $  n  $, 有:
$$
\prod_{k=0}^{n-1} (1 + q^k x) = \sum_{k=0}^n \binom{n}{k}_q q^{\frac{k(k-1)}{2}} x^k
$$
当  $  q \to 1  $  时, 退化为普通二项式定理  $  (1 + x)^n = \sum_{k=0}^n \binom{n}{k} x^k  $, 对于负数情况, 有:
$$
\prod_{k=0}^{n-1}\frac{1}{1 - q^k x}= \sum_{k=0}^\infty \binom{n+k-1}{k}_q x^k,
$$
当  $  q \to 1  $  时, 即为  $  (1 - x)^{-n} = \sum_{k=0}^\infty \binom{n+k-1}{k} x^k  $.
</div>

<div style="border: 3px solid #000; padding: 10px;">

<b>证明:</b>

由归纳法和q-杨辉恒等式即可证明, 但我们这里使用另一种方法证明第一个式子, 这种方法在q-级数理论中十分常用, 第二个式子也可以类似证明.

定义  $  K_n(x)  $  为
$$
K_n(x) = \prod_{k=0}^{n-1} (1 + q^k x) = \sum_{k=0}^n c_k x^k
$$
其中  $  c_k  $  为展开式中  $  x^k  $  的系数, 显然有
$$
(1+q^nx)K_n(x)=(1+x)K_n(qx),
$$
代入幂级数并比较系数得递推公式
$$
c_k+q^nc_{k-1}=q^kc_k+q^{k-1}c_{k-1},
$$
即  $  (1-q^k)c_k=(q^{k-1}-q^n)c_{k-1}  $, 因  $  c_0=1  $, 故  $  c_1=\frac{1-q^n}{1-q}=\binom{n}{1}  $, 若  $  c_{k-1}=\binom{n}{k-1} q^{\frac{(k-1)(k-2)}{2}}  $, 则  $  c_k=\frac{q^{k-1}-q^n}{1-q^k}\binom{n}{k-1} q^{\frac{(k-1)(k-2)}{2}}=\binom{n}{k}q^{k-1}q^{\frac{(k-1)(k-2)}{2}}=\binom{n}{k}q^{\frac{k(k-1)}{2}}  $, 由归纳法知定理成立.

</div>

## q-分析学

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-导数)</b>

设  $  f  $  是一个实函数, 则定义其q-导数为

$$
D_qf(x)=\frac{f(x)-f(qx)}{x-qx},
$$

当  $  f  $  可导时, 令  $  q\to 1  $  有  $  \lim_{q\to1}D_qf(x)=f'(x)  $.
</div>

可做一些简单的计算, 设  $  f(x)=x^a  $, 这里  $  a  $  是任意实数, 则有

$$
D_qx^a=\frac{x^a-(qx)^{a}}{x-qx}=\frac{1-q^a}{1-q}x^{a-1}=[a]_qx^{a-1},
$$

其中  $  [a]_q  $  形式地定义为  $  \frac{1-q^a}{1-q}  $.

显然q-导数是线性的, 即  $  D_q(f+g)=D_qf+D_qg  $,   $  D_q(kf)=kD_qf  $, 并且有q-莱布尼兹律

$$
D_q^n(f(x)g(x))=\sum_{k=0}^n\binom{n}{k}_q\left(D_q^{n-k}f(q^kx)\right)\left(D_q^kg(x)\right),
$$

该公式由归纳法即可证明, 当  $  g\neq 0  $  时, 对  $  \frac{f}{g}  $  亦有对应求导公式.

一个自然的想法是寻找一个在q-导数下不变的函数, 即q-指数函数, 定义为:

$$
\exp_q(x)=\sum_{k=0}^\infty\frac{x^k}{[k]_q!},
$$

则有  $  D_q\exp_q(x)=\exp_q(x)  $, 且  $  \lim\limits_{q\to1}\exp_q(x)=e^x  $. 实际这里定义域可以取到复数, 其中  $  \lvert q\rvert<1  $, 以后我们使用  $  z  $  表示复数.

由此我们可以定义q-三角函数

$$
\sin_q (z)=\frac{\exp_q(iz)-\exp_q(-iz)}{2i},\cos_q (z)=\frac{\exp_q(iz)+\exp_q(-iz)}{2},
$$

当  $  q  $  趋于1时即为通常的三角函数.

接下来定义q-积分.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-积分)</b>

设  $  f  $  在积分域上有定义,   $  a,b\in\mathbb{R}  $, 则q-积分定义为：

$$
\int_0^a f(x) \mathrm{d}_q x = a(1 - q) \sum_{n=0}^\infty f(a q^n) q^n,
$$

$$
\int_0^\infty f(x)\mathrm{d}_q x = (1 - q) \sum_{n=-\infty}^\infty f(q^n) q^n,
$$

$$
\int_b^a f(x) \mathrm{d}_q x =\int_0^a f(x) \mathrm{d}_q x -\int_0^b f(x) \mathrm{d}_q x,
$$

各无界区间的积分类似定义, 若  $  f  $  在积分域内可积, 则当  $  q\to1  $  时即为通常的积分.
</div>

q-积分的线性性是显然的, 接下来证明q-微积分基本定理.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(q-微积分基本定理)</b>

当  $  0<q<1  $  时, 有

$$
D_q\left(\int_0^xf(t)\mathrm{d}_q t\right)=f(x),
$$

$$
\int_0^xD_qf(t)\mathrm{d}t=f(x)-f(0).
$$
</div>

<div style="border: 3px solid #000; padding: 10px;">

<b>证明:</b>

由

$$
\displaylines{D_q\left(\int_0^xf(t)\mathrm{d}_q t\right)=\frac{\int_0^xf(t)\mathrm{d}_qt-\int_0^{qx}f(t)\mathrm{d}_qt}{x-qx}\\
=\sum_{n=0}^\infty f(x q^n) q^n-\sum_{n=0}^\infty f(x q^{n+1}) q^{n+1}=f(x),}
$$

和

$$
\displaylines{\int_0^xD_qf(t)\mathrm{d}t=x(1 - q) \sum_{n=0}^\infty \frac{f(xq^n)-f(xq^{n+1})}{xq^n-xq^{n+1}} q^n\\
=\sum_{n=0}^\infty \left(f(xq^n)-f(xq^{n+1})\right)=f(x)-f(0),}
$$

即可得证.
</div>

如果记  $  D_q(g(t))\mathrm{d}_qt  $  为  $  \mathrm{d}_qg(t)  $, 则有q-黎曼斯蒂尔杰斯积分或q-换元法.

$$
\int_0^xf(t)\mathrm{d}g(t)=\sum_{n=0}^\infty f(xq^n)\left(g(xq^n)-g(xq^{n+1})\right).
$$

q-微积分在q-特殊函数论中有重要的应用, 下面介绍一些重要的q-特殊函数.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-伽马函数)</b>

当  $  |q|<1  $  时, 定义

$$
\Gamma_q(x) =(1 - q)^{1 - x} \frac{(q;q)_\infty}{(q^x;q)_\infty}.
$$
</div>

显然有  $  \Gamma_q(x+1)=[x]_q\Gamma_q(x)  $, 并且当  $  n  $  是正整数时,   $  \Gamma_q(n)=[n-1]_q!  $, 可以证明  $  \lim_{q\to1}\Gamma_q(x)=\Gamma(x)  $.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(q-贝塔函数)</b>

当  $  |q|<1  $  时, 定义

$$
B_q(x,y) = \frac{\Gamma_q(x)\Gamma_q(y)}{\Gamma_q(x+y)}.
$$
</div>

我们知道广义超几何函数定义为

$$
_rF_s(a_1,\dots,a_r;b_1,\dots,b_s;z)= _rF_s\left[
\begin{matrix}a_1 \ldots a_r\\b_1 \ldots b_s\end{matrix};z\right]= \sum_{n=0}^\infty\frac{(a_1)_n\cdots(a_r)_n}{(b_1)_n\cdots(b_s)_n}\frac{z^n}{n!},
$$

其中  $  (a)_n=\frac{\Gamma(a+n)}{\Gamma(a))}=a(a+1)\cdots(a+n-1)  $  为上升阶乘, 当  $  r=2  $,   $  s=1  $  时,   $  _2F_1  $  即为超几何函数, 广义超几何函数在特殊函数论中十分重要, 它的q-模拟称为q-超几何函数或基本超几何函数:

$$
\displaylines{_r\phi_s(a_1,\dots,a_r;b_1,\dots,b_s;q,z)=\ _r\phi_s\left[
 \begin{matrix}
  a_1 \ldots a_r\\
  b_1 \ldots b_s
 \end{matrix}
;q,z\right]\\
=\sum_{n=0}^\infty\frac{(a_1,\dots,a_r;q)_n}{(b_1,\dots,b_s;q)_n}\frac{z^n}{(q,q)_n}\left((-1)^nq^{\frac{n(n-1)}{2}}\right)^{1+s-r},}
$$

有

$$
\displaylines{\lim_{q\to1}\ _r\phi_s\left[
 \begin{matrix}
  q^{a_1} \ldots q^{a_r}\\
  q^{b_1} \ldots q^{b_s}
 \end{matrix}
;q,\left(1-q\right)^{1+s-r}z\right]=\ _rF_s\left[
 \begin{matrix}
  a_1 \ldots a_r\\
  b_1 \ldots b_s
 \end{matrix}
;z\right],}
$$

此外还有双边求和情形, 用  $  \psi  $  表示:

$$
\displaylines{_r\psi_s(a_1,\dots,a_r;b_1,\dots,b_s;q,z)=\ _r\psi_s\left[
 \begin{matrix}
  a_1 \ldots a_r\\
  b_1 \ldots b_s
 \end{matrix}
;q,z\right]\\
=\sum_{n=-\infty}^\infty\frac{(a_1,\dots,a_r;q)_n}{(b_1,\dots,b_s;q)_n}z^n\left((-1)^nq^{\frac{n(n-1)}{2}}\right)^{s-r},}
$$

其中  $  r=s=1  $  时称为拉马努金  $  _1\psi_1  $  求和.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(拉马努金  $  _1\psi_1  $  求和公式)</b>

设  $  a,b,z  $  是复数, 当  $  \left|\frac{b}{a}\right|<|z|<1  $  时有

$$
_1\psi_1(a;b;q,z)=\frac{\left(q,\frac{b}{a},az,\frac{q}{az};q\right)_\infty}{\left(b,\frac{q}{a},z,\frac{b}{az};q\right)_\infty}.
$$
</div>

证明见[1]的定理1.3.12.


## 加性数论

### 加性数论基础

加性数论研究整数的分拆, 该领域最基本的定理由欧拉给出, 设  $  n  $  是一个正整数, 定义  $  p(n)  $  为将  $  n  $  分拆为任意多个可重复正整数的和  $  (  $  不计顺序  $  )  $  的方法数, 则有:

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(欧拉定理)</b>

$$
\frac{1}{(x,x)_\infty}=\frac{1}{(1-x)(1-x^2)(1-x^3)\cdots}=1+\sum_{n=1}^\infty p(n)x^n.
$$
</div>

<div style="border: 3px solid #000; padding: 10px;">

<b>证明:</b>

左边展开为无穷级数就是乘积
$$(1+x+x^2+\cdots)(1+x^2+x^3+\cdots)(1+x^3+x^6+\cdots)\cdots$$
由无穷级数的乘法可知,   $  n  $  的每种分拆法都对应  $  x^n  $  的系数中的一个  $  1  $, 故  $  x^n  $  的系数就是  $  p(n)  $, 严格的证明此处省略.
</div>

类似的方法可以得到更多分拆类型的生成函数, 例如函数

$$
\frac{1}{(1-x)(1-x^3)(1-x^5)\cdots}
$$

就是将  $  n  $  分拆为正奇数之和的方法数的生成函数,

$$
\frac{1}{(1-x^2)(1-x^4)(1-x^6)\cdots}
$$

就是将  $  n  $  分拆为正偶数之和的方法数的生成函数,

$$
(1+x)(1+x^2)(1+x^3)\cdots
$$

是将  $  n  $  分拆为不相等的正整数之和的方法数的生成函数.

由生成函数之间的简单代数关系可以迅速推出一些复杂的数论定理, 例如

$$
(1+x)(1+x^2)\cdots=\frac{1-x^2}{1-x}\frac{1-x^4}{1-x^2}\cdots=\frac{1}{(1-x)(1-x^3)\cdots}
$$

$$
\Longleftrightarrow (-x,x)_\infty=\frac{1}{(x,x^2)_\infty}
$$

暗示将  $  n  $  分拆为不相等的正整数之和的方法数与将  $  n  $  分拆为正奇数之和的方法数相等, 而使用其他方法证明这件事远比生成函数复杂的多.

### 雅可比三重积恒等式

首先定义雅可比theta函数.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(雅可比theta函数)</b>

设  $  z  $  是复数,   $  \tau  $  是上半复平面中的点, 则定义雅可比theta函数为

$$
\theta(z,\tau)=\sum_{n=-\infty}^\infty e^{\pi in^2\tau}e^{2\pi iz},
$$

习惯上做代换  $  q= e^{\pi i\tau}  $  和  $  \eta = e^{2\pi iz}  $  得到

$$
\theta(\eta,q)=\sum_{n=-\infty}^{\infty}q^{n^2}\eta^n,
$$

这里我们滥用了符号, 其中,   $  \eta=e^{2\pi iz}\neq 0  $, 若设  $  \tau=a+bi  $,   $  b>0  $, 则  $  |q|=|e^{\pi i(a+bi)}|=e^{-\pi b}<1  $.
</div>

与之相关的函数是拉马努金theta函数, 但习惯上一般用  $  f  $  表示.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(拉马努金theta函数)</b>

设  $  a,b\in\mathbb{C}  $  且  $  |ab|<1  $, 定义拉马努金theta函数为

$$
f(a,b)=\sum_{n=-\infty}^\infty a^{\frac{n(n+1)}{2}}b^{\frac{n(n-1)}{2}}.
$$
</div>

它有一些特殊情况, 例如拉马努金  $  \varphi  $  函数

$$
\varphi(q)=f(q,q)=\sum_{n=-\infty}^\infty q^{n^2}=\theta(1,q),
$$

拉马努金  $  \psi  $  函数

$$
\psi(q)=f(q,q^3)=\sum_{n=0}^\infty q^{\frac{n(n+1)}{2}},
$$

前文中定义的欧拉函数也是其特例, 这由后文即将证明的欧拉五边形数公式保证,

$$
\phi(q)=(q;q)_\infty=f(-q,-q^2).
$$

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(雅可比三重积恒等式)</b>

设复数  $  |q|<1  $,   $  \eta\neq0  $, 则有

$$
\prod_{n=1}^\infty(1-q^{2n})(1+q^{2n-1}\eta)(1+q^{2n-1}\eta^{-1})=\sum_{n=-\infty}^\infty q^{n^2}\eta^n,
$$

等价的写法是

$$
\theta(q,\eta)=(q^2;q^2)_\infty(-q\eta;q^2)_\infty(-q\eta^{-1};q^2)_\infty=(q^2,-q\eta,-q\eta^{-1};q^2)_\infty.
$$
</div>

该定理的证明有多种方法, 例如[6]的第19.8节, 它也可以由拉马努金  $  _1\psi_1  $  求和公式推出.

一些简单的特例是取  $  \eta=\pm1  $, 有

$$
\varphi(q)=\sum_{n=-\infty}^\infty q^{n^2}=\prod_{n=1}^\infty(1-q^{2n})(1+q^{2n-1})^2,
$$

$$
\sum_{n=-\infty}^\infty (-1)^n q^{n^2}=\prod_{n=1}^\infty(1-q^{2n})(1-q^{2n-1})^2.
$$

在雅可比三重积恒等式中作代换  $  q\mapsto q^{\frac{3}{2}}  $,   $  \eta\mapsto -q^{\frac{1}{2}}  $  得

$$
\sum_{n=-\infty}^\infty (-1)^{n}q^{\frac{n(3n+1)}{2}}=(q^3,q^2,q;q^3)_\infty=(q;q)_\infty,
$$

第二个等号是因为

$$
\prod_{n=1}^\infty(1-q^{3n+3})(1-q^{3n+2})(1-q^{3n+1})=\prod_{n=1}^\infty (1-q^n),
$$

再用  $  -n  $  替换  $  n  $  得到

$$
(-1)^{-n}q^{\frac{-n(-3n+1)}{2}}=(-1)^nq^{\frac{n(3n-1)}{2}}.
$$

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(欧拉五边形数公式)</b>

当复数  $  |q|<1  $  时, 有恒等式

$$
\sum_{n=-\infty}^\infty (-1)^{n}q^{\frac{n(3n-1)}{2}}=(q;q)_\infty.
$$
</div>

该公式称为欧拉五边形数公式, 是因为诸  $  \frac{n(3n-1)}{2}  $  即为所谓的五边形数.

在雅可比三重积恒等式中作代换  $  q\mapsto q^{\frac{1}{2}}  $,   $  \eta\mapsto q^{\frac{1}{2}}\zeta  $, 其中  $  \zeta  $  是不等于  $  0  $  或  $  -1  $  的实数, 则得到

$$
\prod_{n=1}^\infty(1-q^{n})(1+q^{n}\zeta)(1+q^{n-1}\zeta^{-1})=\sum_{n=-\infty}^\infty q^{\frac{n^2+n}{2}}\zeta^n,
$$

等价于

$$
(1+\zeta^{-1})\prod_{n=1}^\infty(1-q^{n})(1+q^{n}\zeta)(1+q^{n}\zeta^{-1})=\sum_{n=1}^\infty q^{\frac{n^2+n}{2}}(\zeta^n+\zeta^{-n-1}),
$$

整理得到

$$
\displaylines{\prod_{n=1}^\infty(1-q^{n})(1+q^{n}\zeta)(1+q^{n}\zeta^{-1})=\sum_{n=1}^\infty q^{\frac{n^2+n}{2}}\zeta^{-n}\frac{1+\zeta^{2n+1}}{1+\zeta}\\
=\sum_{n=1}^\infty q^{\frac{n^2+n}{2}}\zeta^{-n}(1-\zeta+\zeta^2-\cdots+\zeta^{2n}),}
$$

该等式两边对于  $  \zeta=-1  $  均有定义, 并且在  $  -1  $  附近收敛, 故可取  $  \zeta\to-1  $  得到:

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(雅可比恒等式)</b>

当复数  $  |q|<1  $  时, 有

$$
(q;q)_\infty^3=\prod_{n=1}^\infty(1-q^{n})^3=\sum_{n=1}^\infty (-1)^n(2n+1)q^{\frac{n(n+1)}{2}}.
$$
</div>

另一个代换给出拉马努金theta函数的三重积恒等式, 设复数  $  a,b  $  均不为  $  0  $  且  $  \lvert ab\rvert<1  $, 令  $  q=(ab)^{\frac{1}{2}}  $,   $  \eta=a^\frac{1}{2}b^{-\frac{1}{2}}  $, 则有

$$
(q^2,-q\eta,-q\eta^{-1};q^2)_\infty=(ab,-a,-b;ab)_\infty,
$$

$$
\sum_{n=-\infty}^\infty q^{n^2}\eta^n=\sum_{n=-\infty}^\infty a^{\frac{n^2}{2}}b^{\frac{n^2}{2}}a^{\frac{n}{2}}b^{-\frac{n}{2}}=\sum_{n=-\infty}^\infty a^{\frac{n(n+1)}{2}}b^{\frac{n(n-1)}{2}},
$$

当  $  a,b  $  可以取  $  0  $  时约定  $  0^0=1  $  即得:

$$
f(a,b)=(ab,-a,-b;ab)_\infty.
$$

由雅可比三重积恒等式可以推出许多重要的数论定理, 现举几例.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(二平方和定理)</b>

定义  $  r_2(n)  $  为将正整数  $  n  $  表示为两个整数  $  (  $  计正负, 计顺序  $  )  $  的平方和的方法数, 并定义  $  d_1(n)  $  表示  $  n  $  的模  $  4  $  同余于  $  1  $  的正因数个数, 即

$$
d_1(n)=\sum_{\substack{a|n,\\a\equiv1\mod{4}}}1,
$$

同理定义  $  d_3(n)  $  表示  $  n  $  的模  $  4  $  同余于  $  3  $  的正因数个数, 则有

$$
r_2(n)=4(d_1(n)-d_3(n)).
$$
</div>

举一个例子, $  5=1^2+2^2=(-1)^2+2^2=1^2+(-2)^2=(-1)^2+(-2)^2=2^2+1^1=2^2+(-1)^2  $  
$  =(-2)^2+1^2=(-2)^2+(-1)^2  $, 故  $  r_2(5)=8=4(2-0)  $.

当取  $  n  $  为奇素数  $  p  $  时, 立刻得到费马二平方和定理: 如果  $  p\equiv1\mod 4  $, 则  $  d_1(p)=2  $, 即  $  p  $  有两个模  $  4  $  同余于  $  1  $  的正因数, 分别是  $  1  $  和  $  p  $  自身, 而没有模  $  4  $  同余于  $  3  $  的正因数, 故  $  r_2(p)=8>0  $, 如果  $  p\equiv3\mod 4  $, 则  $  d_1(p)=d_3(p)=1  $, 即  $  p  $  有一个模  $  4  $  同余于  $  1  $  的正因数, 即  $  1  $, 有一个模  $  4  $  同余于  $  3  $  的正因数, 即  $  p  $  自身, 故  $  r_2(p)=0  $.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(四平方和定理)</b>

定义  $  r_4(n)  $  为将正整数  $  n  $  表示为四个整数  $  (  $  计正负, 计顺序  $  )  $  的平方和的方法数, 则

$$
r_4(n)=8\sum_{\substack{a\mid n\\4 \nmid a}}a.
$$
</div>

由此立刻得到拉格朗日四平方和定理, 因为对任何正整数  $  n  $,   $  1  $  都一定是其因子并且不能被  $  4  $  整除, 故  $  r_4(n)\ge8>0  $.

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(二三角形数和定理,四三角形数和定理)</b>

首先定义三角形数为形如  $  \frac{k(k+1)}{2}  $  的数, 其中  $  k  $  是非负整数, 定义  $  t_2(n)  $  为将正整数  $  n  $  表示为两个三角形数  $  (  $  计顺序  $  )  $  的和的方法数,   $  t_4(n)  $  为将正整数  $  n  $  表示为四个三角形数  $  (  $  计顺序  $  )  $  的和的方法数, 则有

$$
t_2(n)=d_1(4n+1)-d_3(4n+1),
$$

$$
t_4(n)=\sigma(2n+1)=\sum_{a\mid 2n+1}a.
$$
</div>

例如, $  3=3+0=0+3  $, 故 $  t_2(3)=2=2-0  $, 因为  $  3=1+1+1+0=1+1+0+1  $  
  $  =1+0+1+1=0+1+1+1=3+0+0+0=0+3+0+0=0+0+3+0=  $  
  $  0+0+0+3  $, 故  $  t_4(3)=8=1+7  $. 显然有  $  t_4(n)\ge2n+2\ge4>0  $  对任意正整数都成立, 而  $  t_2(n)  $  则未必不等于  $  0  $, 例如  $  t_2(5)=2-2=0  $, 但高斯三角形数定理表明, 对任意正整数一定有  $  t_3(n)>0  $, 即任意正整数都可以表示为三个三角形数的和.

我们定义  $  r_k(n)  $  为将正整数  $  n  $  表示为  $  k  $  个整数  $  (  $  计正负, 计顺序  $  )  $  的平方和的方法数,   $  t_k(n)  $  为将正整数  $  n  $  表示为  $  k  $  个三角形数  $  (  $  计顺序  $  )  $  的和的方法数, 约定  $  r_k(0)=1  $,   $  t_k(0)=1  $, 则它们的生成函数是

$$
\sum_{n=0}^\infty r_k(n)q^n=\left(\sum_{n=-\infty}^\infty q^{n^2}\right)^k=\left(\varphi(q)\right)^k,
$$

$$
\sum_{n=0}^\infty t_k(n)q^n=\left(\sum_{n=0}^\infty q^{\frac{n(n+1)}{2}}\right)^k=\left(\psi(q)\right)^k.
$$

接下来考虑兰伯特级数

$$
\sum_{n=1}^\infty\frac{q^n}{1-q^n},
$$

将它展开为幂级数,

$$
\sum_{n=1}^\infty\frac{q^n}{1-q^n}=\sum_{n=1}^\infty\left(q^n+q^{2n}+q^{3n}+\cdots\right)=\sum_{n=1}^\infty d(n)q^n,
$$

其中  $  d(n)  $  显然是  $  n  $  的正因子个数, 类似的, 设  $  a  $  是正整数,   $  b  $  是非负整数, 展开

$$
\sum_{n=0}^\infty\frac{q^{an+b}}{1-q^{an+b}}=\sum_{n=0}^\infty\left(q^{an+b}+q^{2(an+b)}+q^{3(an+b)}+\cdots\right)=\sum_{n=0}^\infty d_{a,b}(n)q^n,
$$

其中  $  d_{a,b}(n)  $  表示的是  $  n  $  的模  $  a  $  同余于  $  b  $  的正因数个数, 因为上述求和中每个满足  $  m(ak+b)=n  $  的数  $  m(ak+b)  $  提供一个  $  1  $, 而  $  ak+b  $  就是一个  $  n  $  的模  $  a  $  同余于  $  b  $  的正因数.

设  $  a(n)  $  是算术函数, 则有

$$
\sum_{n=1}^\infty\frac{a(n)q^{n}}{1-q^{n}}=\sum_{n=1}^\infty\left(a(n)q^{n}+a(n)q^{2n}+a(n)q^{3n}+\cdots\right)=\sum_{n=1}^\infty b(n)q^n,
$$

其中  $  b(n)=\sum_{k\mid n}a(k)  $, 故

$$
\sum_{n=1}^\infty\frac{nq^{n}}{1-q^{n}}=\sum_{n=1}^\infty \sigma(n)q^n.
$$

因此, 之前的三个定理就等价于以下四个等式:

$$
\left(\sum_{n=-\infty}^\infty q^{n^2}\right)^2=1+4\sum_{n=0}^\infty\left(\frac{q^{4n+1}}{1-q^{4n+1}}-\frac{q^{4n+3}}{1-q^{4n+3}}\right),
$$

$$
\left(\sum_{n=-\infty}^\infty q^{n^2}\right)^4=1+8\sum_{n=1}^\infty\left(\frac{nq^{n}}{1-q^{n}}-\frac{4nq^{4n}}{1-q^{4n}}\right),
$$

$$
8q\left(\psi(q^4)\right)^2=(\varphi(q))^2-(\varphi(-q))^2,
$$

$$
16q\left(\psi(q^2)\right)^4=(\varphi(q))^4-(\varphi(-q))^4,
$$

其中后两式与原命题的等价性依赖于前两式, 因为

$$
8q\left(\psi(q^4)\right)^2=8\sum_{n=0}^\infty t_2(n)q^{4n+1},
$$

$$
\displaylines{(\varphi(q))^2-(\varphi(-q))^2=\sum_{n=0}^\infty r_2(n)q^n-\sum_{n=0}^\infty r_2(n)(-q)^n\\
=4\sum_{n=0}^\infty (d_1(n)-d_3(n))(q^n-(-q)^n),}
$$

故有

$$
\displaylines{8q\left(\psi(q^4)\right)^2=(\varphi(q))^2-(\varphi(-q))^2\\
\Longleftrightarrow\sum_{n=0}^\infty t_2(n)q^{4n+1}=\frac{1}{2}\sum_{n=0}^\infty \left(d_1(n)-d_3(n)\right)\left(q^n-(-q)^n\right),}
$$

其中等式右边, 当  $  n  $  是偶数时,   $  q^n-(-q)^n=0  $, 当  $  n  $  形如  $  4k+3  $  时,   $  d_1(n)-d_3(n)=0  $, 因为如果  $  a  $  是  $  n  $  的形如  $  4k+1  $  的因数, 那么  $  \frac{n}{a}  $  必然形如  $  4k+3  $, 即  $  n  $  的因数中模  $  4  $  同余于  $  1  $  和模  $  4  $  同余于  $  3  $  的个数相同, 因此上式右边只有  $  q^{4n+1}  $  项, 比较系数即得  $  t_2(n)=d_1(4n+1)-d_3(4n+1)  $.

类似的, 因为

$$
16q\left(\psi(q^2)\right)^4=16\sum_{n=0}^\infty t_4(n)q^{2n+1},
$$

$$
(\varphi(q))^4-(\varphi(-q))^4=\sum_{n=0}^\infty r_4(n)q^n-\sum_{n=0}^\infty r_4(n)(-q)^n=8\sum_{n=0}^\infty \left(\sum_{\substack{a\mid n\\4 \nmid a}}a\right)\left(q^n-(-q)^n\right),
$$

故有

$$
16q\left(\psi(q^2)\right)^4=(\varphi(q))^4-(\varphi(-q))^4\Longleftrightarrow\sum_{n=0}^\infty t_4(n)q^{2n+1}=\frac{1}{2}\sum_{n=0}^\infty \left(\sum_{\substack{a\mid n\\4 \nmid a}}a\right)\left(q^n-(-q)^n\right),
$$

当  $  n  $  是偶数时,   $  q^n-(-q)^n=0  $, 所以等式右边只有奇数次项, 比较系数即得  $  t_4(n)=\sum\limits_{\substack{a\mid 2n+1 \\\\ 4 \nmid a}}a  $, 因为奇数的因数一定不是  $  4  $  的倍数, 故  $  4\nmid a  $  条件多余, 即有  $  t_4(n)=\sum_{\substack{a\mid 2n+1}}a=\sigma(2n+1)  $.

这些公式均可由雅可比三重积恒等式和拉马努金  $  _1\psi_1  $  求和公式及一些恒等变换得到, 我们仅以第一式为例做具体证明.

<div style="border: 3px solid #000; padding: 10px;">

<b>证明:(二平方和定理的证明)</b>

在雅可比三重积恒等式中令  $  \eta=1  $  得到

$$
\varphi(q)=(q^2;q^2)_\infty(-q;q^2)^2_\infty,
$$

由拉马努金  $  _1\psi_1  $  求和公式得

$$
\displaylines{_1\psi_1(-1;-q^2;q^2,q)=\frac{(q^2,q^2,-q,-q;q^2)_\infty}{(-q^2,-q^2,q,q;q^2)_\infty}=\\
\frac{(q^2;q^2)^2_\infty(-q;q^2)^2_\infty(-q;q)^2_\infty}{(-q^2;q^2)^2_\infty}=(q^2;q^2)^2_\infty(-q;q^2)^4_\infty,}
$$

$$
_1\psi_1(-1;-q^2;q^2,q)=\sum_{n=-\infty}^\infty\frac{(-1;q^2)_n q^n}{(-q^2;q^2)_n}=\sum_{n=-\infty}^\infty\frac{2q^n}{1+q^{2n}}=1+4\sum_{n=1}^\infty\frac{q^n}{1+q^{2n}},
$$

故

$$
1+4\sum_{n=1}^\infty\frac{q^n}{1+q^{2n}}=(q^2;q^2)^2_\infty(-q;q^2)^4_\infty=\left(\varphi(q)\right)^2.
$$

左边展开为幂级数并交换求和顺序得

$$
\sum_{n=1}^\infty\frac{q^n}{1+q^{2n}}=\sum_{n=1}^\infty q^n\sum_{k=0}^\infty(-1)^{k}q^{2nk}=\sum_{k=0}^\infty(-1)^k\sum_{n=1}^\infty q^{n(2k+1)}=\sum_{k=0}^\infty\frac{(-1)^kq^{2k+1}}{1-q^{2k+1}},
$$

分奇偶求和, 得到

$$
\left(\varphi(q)\right)^2=1+4\sum_{k=0}^\infty\frac{(-1)^kq^{2k+1}}{1-q^{2k+1}}=1+4\sum_{n=0}^\infty\left(\frac{q^{4n+1}}{1-q^{4n+1}}-\frac{q^{4n+3}}{1-q^{4n+3}}\right),
$$

这等价于原定理.
</div>

### 罗杰斯-拉马努金恒等式

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(罗杰斯-拉马努金恒等式)</b>
\begin{align*}
&1+\frac{q}{(1-q)}+\frac{q^4}{(1-q)(1-q^2)}
+\frac{q^9}{(1-q)(1-q^2)(1-q^3)}+\cdots \\
=&\frac{1}{(1-q)(1-q^6)(1-q^{11})(1-q^{16})\cdots}\frac{1}{(1-q^4)(1-q^9)(1-q^{14})\cdots};
\end{align*}
\begin{align*}
&1+\frac{q^2}{(1-q)}+\frac{q^6}{(1-q)(1-q^2)}
+\frac{q^{12}}{(1-q)(1-q^2)(1-q^3)}+\cdots \\
=&\frac{1}{(1-q^2)(1-q^7)(1-q^{12})(1-q^{17})\cdots}\frac{1}{(1-q^3)(1-q^8)(1-q^{13})\cdots }.
\end{align*}
等价的写法是
$$
\sum_{n=0}^\infty\frac{q^{n^2}}{(q;q)_n}=\frac{1}{(q;q^5)_\infty(q^4;q^5)_\infty},
$$
$$
\sum_{n=0}^\infty\frac{q^{n(n+1)}}{(q;q)_n}=\frac{1}{(q^2;q^5)_\infty(q^3;q^5)_\infty}.
$$
</div>

它的证明参见[6]的第19.13节和19.14节。

接下来介绍罗杰斯-拉马努金恒等式的组合意义, 以第一式为例, 等式右边是将非负整数  $  n  $  分拆为形如  $  5k+1  $  或  $  5k+4  $  的数的和的方法数的生成函数, 对于等式左边, 因为  $  n^2=1+3+\cdots+(2n-1)  $, 故

$$

\frac{q^{n^2}}{(1-q)\cdots(1-q^n)}=q^{1+3+\cdots+(2n-1)}(1+q+\cdots)(1+q^2+\cdots)\cdots(1+q^{2n-1}+\cdots),

$$

设等式右边无穷级数的无穷乘积得到的结果中,   $  q^{k-n^2}  $  的系数是将  $  k-n^2  $  拆分为至多  $  n  $  个正整数的和的方法数, 假设  $  k-n^2=a_1+\cdots+a_n  $, 并且适当排序使得  $  0\le a_1\le a_2\le\cdots\le a_s  $, 则将  $  q^{1+3+\cdots+(2n-1)}  $  乘进去后, 该分拆就对应  $  k  $  的分拆  $  (1+a_1)+(3+a_2)+\cdots+(2n-1+a_n)  $, 故  $  q^k  $  的系数就是将  $  k  $  拆分为至少相差  $  2  $  的  $  n  $  个不同数的和的方法数, 再求和就知道,   $  \sum_{n=0}^\infty\frac{q^{n^2}}{(q;q)_n}  $  的幂级数展开式中  $  q^k  $  的系数就是将  $  k  $  拆分为至少相差  $  2  $  的不同数的和的方法数, 由此得到:

<div style="border: 3px solid #000; padding: 10px;">

<b>定理</b>
将正整数  $  n  $  分拆为至少相差  $  2  $  的不同数的和的方法数与分拆为形如  $  5k+1  $  或  $  5k+4  $  的数的和的方法数相等.
</div>

例如,   $  n=9  $  时, 按第一种拆分法,   $  9=1+8=2+7=3+6=1+3+5  $, 共五种, 按第二种拆分法,   $  9=1+1+1+1+1+1+1+1+1=4+1+1+1+1+1=6+1+1+1  $  
  $  =4+4+1  $, 也是五种.

类似的, 第二个式子的组合意义是:

<div style="border: 3px solid #000; padding: 10px;">

<b>定理</b>
将正整数  $  n  $  分拆为不小于  $  2  $  且至少相差  $  2  $  的不同数的和的方法数与分拆为形如  $  5k+2  $  或  $  5k+3  $  的数的和的方法数相等.
</div>

还有更多类似罗杰斯-拉马努金恒等式的公式, 它们被统称为类罗杰斯-拉马努金恒等式.

与罗杰斯-拉马努金恒等式相关的是罗杰斯-拉马努金连分数.

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(罗杰斯-拉马努金连分数)</b>
称以下形式连分数为罗杰斯-拉马努金连分数:
$$
R(q)=\cfrac{q^{\frac{1}{5}}}{1+\cfrac{q}{1+\cfrac{q^2}{1+\cfrac{q^3}{1+\cdots}}}},
$$
与之相关的,
$$
F(q)=q^{-\frac{1}{5}}R(q),
$$
$$
T(q)=\cfrac{1}{F(q)}=1+\cfrac{q}{1+\cfrac{q^2}{1+\cfrac{q^3}{1+\cdots}}},
$$
当  $  |q|<1  $  时它们收敛.
</div>

一个简单的特例是

$$

R(1)=\cfrac{1}{1+\cfrac{1}{1+\cfrac{1}{1+\cdots}}}=\frac{\sqrt{5}-1}{2}.

$$

设

$$

R(z,q)=1+\frac{zq}{1+\cfrac{zq^2}{1+\cfrac{zq^3}{1+\cdots}}},

$$

称其为广义罗杰斯-拉马努金连分数, 显然

$$

R(z,q)=1+\frac{zq}{R(zq,q)}.

$$

设其渐进分数为  $  R_n(z,q)  $, 则  $  R_0(z,q)=1  $,   $  R_1(z,q)=1+zq  $,   $  R_2(z,q)=\frac{1+zq+zq^2}{1+zq^2}  $, 以此类推. 设  $  R_n(z,q)  $  的分子是多项式  $  H_n(z,q)  $, 分母是多项式  $  Q_n(z,q)  $, 即  $  R_n(z,q)=\frac{H_n(z,q)}{Q_{n}(zq,q)}  $, 从而有递推公式

$$

\frac{H_n(z,q)}{Q_n(z,q)}=1+\frac{zq}{\cfrac{H_{n-1}(zq,q)}{Q_{n-1}(zq,q)}}=\frac{H_{n-1}(zq,q)+zqQ_{n-1}(zq,q)}{H_{n-1}(zq,q)},

$$

故有  $  Q_n(z,q)=H_{n-1}(zq,q)  $, 进而有  $  H_n(z,q)=H_{n-1}(zq,q)+zqH_{n-2}(zq^2,q)  $.

现在假设连分数收敛, 则有

$$

R(z,q)=\lim_{n\to\infty}R_n(z,q)=\lim_{n\to\infty}\frac{H_n(z,q)}{H_{n-1}(zq,q)}=\frac{H(z,q)}{H(zq,q)},

$$

其中  $  \lim_{n\to\infty}H_n(z,q)=H(z,q)  $, 满足递推公式

$$

H(z,q)=H(zq,q)+zqH(zq^2,q),

$$

将  $  H(z,q)  $  表示为一个以  $  z  $  为变量的幂级数

$$

H(z,q)=\sum_{n=0}^\infty a_n(q)z^n,

$$

则

$$

\displaylines{\sum_{n=0}^\infty a_n(q)z^n=\sum_{n=0}^\infty a_n(q)q^nz^n+\sum_{n=0}^\infty a_n(q)q^{2n+1}z^{n+1}=\\
a_0(q)+\sum_{n=1}^\infty \left(a_n(q)q^n+a_{n-1}(q)q^{2n-1}\right)z^n,}

$$

故当  $  n>0  $  时有递推公式

$$

a_n(q)=a_n(q)q^n+a_{n-1}q^{2n-1}\Longleftrightarrow a_n(q)=\frac{q^{2n-1}}{1-q^n}a_{n-1}(q),

$$

所以

$$
a_n(q)=\frac{q^{2n-1}}{1-q^n}a_{n-1}(q)=\frac{q^{2n-3}}{1-q^{n-1}}a_{n-2}(q)=\frac{q^{n^2}}{(q;q)_n}a_0(q),

$$

即

$$

H(z,q)=a_0(q)\sum_{n=0}^\infty \frac{q^{n^2}}{(q;q)_n}z^n,

$$

故有

$$

R(z,q)=\frac{\sum\limits_{n=0}^\infty \frac{q^{n^2}}{(q;q)_n}z^n}{\sum\limits_{n=0}^\infty \frac{q^{n^2+n}}{(q;q)_n}z^n},

$$

令  $  z=1  $  即得

$$

T(q)=R(1,q)=\frac{\sum\limits_{n=0}^\infty \frac{q^{n^2}}{(q;q)_n}}{\sum\limits_{n=0}^\infty \frac{q^{n(n+1)}}{(q;q)_n}}=\frac{(q^2;q^5)_\infty(q^3;q^5)_\infty}{(q;q^5)_\infty(q^4;q^5)_\infty},

$$

$$

R(q)=q^{\frac{1}{5}}\frac{(q;q^5)_\infty(q^4;q^5)_\infty}{(q^2;q^5)_\infty(q^3;q^5)_\infty}.

$$

拉马努金声称当  $  q=e^{-\pi\sqrt{t}}  $  当  $  t  $  是正有理数时  $  R(q)  $  是代数数[5], 例如  $  t=4  $  时为著名的拉马努金连分数

$$

R(e^{-2\pi})=\cfrac{e^{-\frac{2\pi}{5}}}{1+\cfrac{e^{-2\pi}}{1+\cfrac{e^{-4\pi}}{1+\cdots}}}=\sqrt{\frac{5+\sqrt{5}}{2}}-\frac{\sqrt{5}+1}{2},

$$

我们这里仅证明这一简单情形, 证明来自[4].

<div style="border: 3px solid #000; padding: 10px;">

<b>定理</b>
  $  R(q)  $  如前所述, 则有
$$
\frac{1}{R(q)}-1-R(q)=q^{-\frac{1}{5}}\frac{(q^\frac{1}{5};q^\frac{1}{5})_\infty}{(q^5;q^5)_\infty}.
$$
</div>
<div style="border: 3px solid #000; padding: 10px;">

<b>证明:</b>
<details>
<summary>点击展开</summary>
定理等价于
$$
\frac{1}{F(q)}-q^{\frac{1}{5}}-q^{\frac{2}{5}}F(q)=\frac{(q^\frac{1}{5};q^\frac{1}{5})_\infty}{(q^5;q^5)_\infty},
$$
其中
$$
F(q)=\frac{(q;q^5)_\infty(q^4;q^5)_\infty}{(q^2;q^5)_\infty(q^3;q^5)_\infty}.
$$

由欧拉五边形数定理知
$$
\frac{(q^\frac{1}{5};q^\frac{1}{5})_\infty}{(q^5;q^5)_\infty}=\frac{\sum\limits_{n=-\infty}^\infty (-1)^{n}q^{\frac{n(3n-1)}{10}}}{\sum\limits_{n=-\infty}^\infty (-1)^{n}q^{\frac{5n(3n-1)}{2}}}\\
$$
$$
=\frac{\sum\limits_{n\equiv0,2\mod5} (-1)^{n}q^{\frac{n(3n-1)}{10}}+\sum\limits_{n\equiv3,4\mod5} (-1)^{n}q^{\frac{n(3n-1)}{10}}+\sum\limits_{n\equiv1\mod5}(-1)^{n}q^{\frac{n(3n-1)}{10}}}{\sum\limits_{n=-\infty}^\infty (-1)^{n}q^{\frac{5n(3n-1)}{2}}}
$$
因为分别  $  n\equiv0,1,2,3,4\mod5  $  时有  $  \frac{n(3n-1)}{2}\equiv0,1,0,2,2\mod5  $, 故上式分子中第一项里  $  q  $  的指数均为整数, 除以分子得到的就是一个幂级数, 设为  $  J_1(q)  $, 第二项里  $  q  $  的指数均为整数加  $  \frac{2}{5}  $  的形式, 除以分子得到的就是  $  q^{\frac{2}{5}}  $  乘一个幂级数, 设为  $  q^\frac{2}{5}J_2(q)  $, 第三项  $  q  $  的指数均为整数加  $  \frac{1}{5}  $  的形式, 事实上, 设  $  n=5k+1  $, 则有  $  \frac{n(3n-1)}{10}=\frac{1}{5}+\frac{5k(3k+1)}{2}=\frac{1}{5}+\frac{5(-k)(-3k-1)}{2}  $, 而  $  k  $  的奇偶性与  $  n  $  的奇偶性恰好相反, 所以第三项除以分子得到的恰好是  $  -q^{\frac{1}{5}}  $, 故有
$$
\frac{(q^\frac{1}{5};q^\frac{1}{5})_\infty}{(q^5;q^5)_\infty}=J_1(q)-q^\frac{1}{5}+q^\frac{2}{5}J_2(q),
$$
由雅可比恒等式知
$$
\frac{(q^\frac{1}{5};q^\frac{1}{5})^3_\infty}{(q^5;q^5)^3_\infty}=\frac{\sum_{n=1}^\infty (-1)^n(2n+1)q^{\frac{n(n+1)}{10}}}{\sum_{n=1}^\infty (-1)^n(2n+1)q^{\frac{5n(n+1)}{2}}},
$$
类似的方法可以说明有
$$
\frac{(q^\frac{1}{5};q^\frac{1}{5})^3_\infty}{(q^5;q^5)^3_\infty}=G_1(q)+G_2(q)q^\frac{1}{5}+5q^\frac{3}{5},
$$
其中  $  G_1(q)  $  和  $  G_2(q)  $  均为幂级数, 另一方面, 因为
$$
\displaylines{\left(J_1-q^\frac{1}{5}+q^\frac{2}{5}J_2\right)^3 =\left(J_1^3 - 3J_2^2 q\right) - q^{\frac{1}{5}}\left(3J_1^2 - J_2^3 q\right) + 3J_1 q^{\frac{2}{5}}\left(1 + J_1 J_2\right) \\
- q^{\frac{3}{5}}\left(1 + 6J_1 J_2\right) + 3J_2 q^{\frac{4}{5}}\left(1 + J_1 J_2\right),}
$$
比较系数得到
$$
J_1J_2+1=0, J_2=-\frac{1}{J_1},
$$
故有
$$
\frac{(q^\frac{1}{5};q^\frac{1}{5})_\infty}{(q^5;q^5)_\infty}=J_1(q)-q^\frac{1}{5}-\frac{q^\frac{2}{5}}{J_1(q)}.
$$

如前所述,
\begin{align*}
J_1(q)(q^5;q^5)_\infty&=\sum\limits_{n\equiv0,2\mod5} (-1)^{n}q^{\frac{n(3n-1)}{10}}\\
&=\sum\limits_{k=-\infty}^\infty (-1)^{k}\left(q^{\frac{k(15k-1)}{2}}+ q^{\frac{(5k+2)(3k+1)}{2}}\right)\\
&=\sum\limits_{k=-\infty}^\infty (-1)^{k}\left(q^{\frac{k(15k+1)}{2}}+ q^{\frac{(5k-2)(3k-1)}{2}}\right),
\end{align*}
现令
$$
\phi(z,q) = \prod_{n=1}^{\infty}(1 + q^{5n-1}z^{-1})(1 + q^{5n-4}z)(1 - q^{10n-7}z^{-2})(1 - q^{10n-3}z^2),
$$
显然有
$$
\phi(z,q)=-q^8z^3\phi(zq^5,q),
$$
设  $  \phi  $  的幂级数展开为
$$
\phi(z,q)=\sum_{n=-\infty}^\infty a_nz^n,
$$
故有递推公式
$$
a_{n+3}=-q^{5n+8}a_n,
$$
另一方面, 由  $  \phi(\frac{q^3}{z},q)=-\frac{z^2}{q^3}\phi(z,q)  $  可得
$$
a_{-n}=-q^{8n-3}a_{n-2},
$$
可解得  $  a_{-1}=-q^{5}a_{-1}  $, 故  $  a_2=-q^{3}a_{-1}=0  $, 还有  $  a_1=-q^{-6}a_{-3}=qa_0  $, 由递推公式可解得各  $  a_n  $, 化简得
$$
\phi(z,q) = a_0 \left( \sum_{n=-\infty}^{\infty} (-1)^n q^{\frac{n(15n + 1)}{2}} z^{3n} + \sum_{n=-\infty}^{\infty} (-1)^n q^{\frac{(5n + 2)(3n + 1)}{2}} z^{3n + 1} \right),
$$
为求得  $  a_0  $, 代入  $  z=\frac{1}{q}  $  得
$$
\prod_{n=1}^{\infty} \left( \frac{1 - q^{10n}}{1 - q^{5n}} \right)^2 (1 - q^{10n - 5})^2 = a_0 \sum_{n=-\infty}^{\infty} (-1)^n q^{\frac{5n(3n + 1)}{2}},
$$
等式左边分子分母消掉后即为  $  1  $, 等式右边相当于  $  a_0(q^5,q^5)_\infty  $, 从而有
$$
\phi(z,q)(q^5;q^5)_\infty=\sum\limits_{k=-\infty}^\infty (-1)^{k}\left(q^{\frac{k(15k+1)}{2}}z^{3n} + q^{\frac{(5k-2)(3k-1)}{2}}z^{1-3n}\right),
$$
代入  $  z=1  $  即得
$$
J_1(q)=\phi(1,q)=\prod_{n=1}^{\infty}(1 + q^{5n-1})(1 + q^{5n-4})(1 - q^{10n-7})(1 - q^{10n-3}),
$$
化简得
$$
J_1(q)=\frac{(q^2;q^5)_\infty(q^3;q^5)_\infty}{(q^1;q^5)_\infty(q^4;q^5)_\infty}=\frac{1}{F(q)},
$$
代入  $  J_1  $  就有
$$
\frac{1}{F(q)}-q^{\frac{1}{5}}-q^{\frac{2}{5}}F(q)=\frac{(q^\frac{1}{5};q^\frac{1}{5})_\infty}{(q^5;q^5)_\infty},
$$
定理得证.
</details>
</div><br>

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(戴德金  $  \eta  $  函数)</b>
设  $  \tau  $  为上半平面中的点, 令  $  q=e^{2\pi i\tau}  $, 定义戴德金  $  \eta  $  函数为
$$
\eta(\tau)=q^{\frac{1}{24}}(q;q)_\infty.
$$
</div><br>

<div style="border: 3px solid #000; padding: 10px;">

<b>定理(戴德金  $  \eta  $  函数的函数方程)</b>
  $  \eta  $  函数如上定义, 则有
$$
\eta(-\frac{1}{\tau})=\sqrt{-i\tau}\cdot\eta(\tau).
$$
</div>

该函数方程的证明可由经典椭圆函数理论加傅里叶分析中的泊松求和公式证明, 也可由模形式理论推得, 见[7]第2.4节.

<div style="border: 3px solid #000; padding: 10px;">

<b>拉马努金连分数的证明:</b>
在戴德金  $  \eta  $  函数中取  $  \tau  $  分别为  $  5i  $  和  $  -\frac{1}{5i}  $  得
$$
\eta(5i) = e^{-\frac{5\pi}{12}} \prod_{n=1}^\infty \left( 1 - e^{-10\pi n} \right)=e^{-\frac{5\pi}{12}}(e^{-10\pi };e^{-10\pi })_\infty,
$$
$$
\eta\left(-\frac{1}{5i}\right) = e^{-\frac{\pi}{60}} \prod_{n=1}^\infty \left(1 - e^{-\frac{2\pi n}{5}}\right)=e^{-\frac{\pi}{60}}(e^{-\frac{2\pi}{5}};e^{-\frac{2\pi}{5}})_\infty,
$$
由函数方程知,
$$
\frac{(e^{-\frac{2\pi}{5}};e^{-\frac{2\pi}{5}})_\infty}{(e^{-10\pi };e^{-10\pi })_\infty}=\sqrt{5}e^{-\frac{2\pi}{5}},
$$
在  $  R(q)  $  中令  $  q=e^{-2\pi}  $  得
$$
\frac{1}{R(e^{-2\pi})}-1-R(e^{-2\pi})=e^{\frac{2\pi}{5}}\frac{(e^{-\frac{2\pi}{5}};e^{-\frac{2\pi}{5}})_\infty}{(e^{-10\pi };e^{-10\pi })_\infty}=\sqrt{5},
$$
解二次方程并适当取根即得
$$
R(e^{-2\pi})=\cfrac{e^{-\frac{2\pi}{5}}}{1+\cfrac{e^{-2\pi}}{1+\cfrac{e^{-4\pi}}{1+\cdots}}}=\sqrt{\frac{5+\sqrt{5}}{2}}-\frac{\sqrt{5}+1}{2},
$$
这就是著名的拉马努金连分数.
</div>

### 拉马努金猜想

<div style="border: 3px solid #000; padding: 10px;">

<b>定义(模判别式  $  \Delta  $  函数)</b>
定义所谓的模判别式  $  \Delta  $  函数为
$$
\Delta(\tau)=q(q;q)_\infty^{24}=q\prod_{n=1}^\infty(1-q^n)^{24},
$$
其中  $  q=e^{2\pi i\tau}  $,   $  \tau  $  取值于上半平面, 显然, 它是戴德金  $  \eta  $  函数的  $  24  $  次方.
</div>

将模判别式展开为  $  q  $  级数, 记作
$$
\Delta(\tau)=\sum_{n=1}^\infty\tau(n)q^n,
$$
其中系数  $  \tau(n)  $  称为拉马努金  $  \tau  $  函数, 需要小心此处的符号滥用.

拉马努金证明了对任意素数  $  p  $  都有  $  \tau(p)\equiv 1+p^{11}\mod 691  $, 更一般的有  $  \tau(n)\equiv\sigma_{11}(n)\mod 691  $, 除此之外还有许多其他同余性质.

拉马努金猜想,   $  \tau  $  函数是一个乘性函数, 即  $  \gcd(a,b)=1  $  时  $  \tau(ab)=\tau(a)\tau(b)  $, 考虑其狄利克雷  $  L  $  级数, 拉马努金猜想有欧拉乘积

$$

\sum_{n=1}^\infty\frac{\tau(n)}{n^s}=\prod_{p}(1-\tau(p)p^{-s}+p^{11-2s})^{-1},

$$

并且对任意素数  $  p  $, 猜想有估计  $  \lvert\tau(p)\rvert\le2p^{\frac{11}{2}}  $, 该不等式单独被称为拉马努金猜想.

前两个猜想由莫德尔于1917年证明, 而不等式由韦伊猜想所蕴含, 并被德利涅于1974年证明.



## 参考文献

[1] Berndt, B. C. Number Theory in the Spirit of Ramanujan [M]. Student Mathematical Library, vol. 34. Providence, RI: American Mathematical Society, 2006.

[2] Bhatnagar, G. Ramanujan Explained [EB/OL]. 2024. [https://ramanujanexplained.org/](https://ramanujanexplained.org/).

[3] Stein, E. M., and R. Shakarchi. Complex Analysis [M]. 1st ed. Princeton Lectures in Analysis, Volume 2. Princeton, NJ: Princeton University Press, 2003.

[4] Watson, G. N. Theorems Stated by Ramanujan (VII): Theorems on Continued Fractions [J]. Journal of the London Mathematical Society, 1929, 4(1): 39–48.

[5] Zhang, L.-C., H. H. Chan, and B. C. Berndt. Explicit Evaluations of the Rogers-Ramanujan Continued Fraction [J]. Journal für die reine und angewandte Mathematik (Crelles Journal), 1996, 480(1): 141–160.

[6] 戈弗雷·哈代, 爱德华·赖特, 戴维·希思-布朗, 等. 哈代数论 [M]. 第6版. 北京: 人民邮电出版社, 2021.

[7] 李文威. 模形式初步 [M]. 北京: 高等教育出版社, 2019.


-----------

本文的PDF版本见: <a href="{{ site.baseurl }}/pdf/q_模拟和q_级数及其应用_整数分拆__雅可比三重积恒等式__罗杰斯_拉马努金恒等式等_.pdf">q-模拟和q-级数及其应用(整数分拆, 雅可比三重积恒等式, 罗杰斯-拉马努金恒等式等)</a>
